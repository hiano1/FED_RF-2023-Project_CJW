<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>

        <style>
            * {
                box-sizing: border-box;
            }

            body {
                font-family: sans-serif;
                text-align: center;
                background-color: rgb(28, 28, 28);
            }
            .scene {
                width: 95vw;
                height: 80vh;
                margin: 5vw auto;
                perspective: 1000px;
            }

            .carousel {
                position: relative;
                width: 100%;
                height: 100%;
                transform-style: preserve-3d;
                transition: transform 1s;
            }
            .carousel_cell {
                position: absolute;
                display: flex;
                width: 100%;
                height: 100%;
                border-radius: 50px;
                text-align: center;
                transition: transform 1s;
                overflow: hidden;
            }
            .album_list {
                width: 50%;
                position: relative;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            .album_art {
                width: 80%;
                aspect-ratio: 1 / 1;
                background-color: green;
                background-image: url(../resource/art01.jpg);
                border-radius: 15px;

                background-size: cover;
            }
            .album_text {
                width: 80%;
                margin-top: 5px;
                border-radius: 15px;
                background-color: rgb(51, 51, 51);
                color: rgb(230, 230, 230);
            }

            .artist_img {
                width: 50%;
                background-image: linear-gradient(
                        to left,
                        rgba(28, 28, 28, 0) 0%,
                        rgba(28, 28, 28, 0.2) 20%,
                        rgba(28, 28, 28, 0.4) 40%,
                        rgba(28, 28, 28, 0.6) 60%,
                        rgba(28, 28, 28, 1) 100%
                    ),
                    url("../resource/img/ariana.webp");
                background-size: cover;
                filter: grayscale();
                z-index: 0;
            }
            .slider {
                position: absolute;
                top: 15%;
                left: -60%;
                width: 100vw;
                height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: visible;
            }
            .wrapper {
                display: flex;
                justify-content: center;
                position: relative;
                box-sizing: border-box;
                padding: 0;
                color: white;
            }
            .controls__left,
            .controls__right {
                position: absolute;
                transition: 0.6s all;
            }
            .icon-wrapper {
                color: white;
                font-size: 1.5em;
            }
            .controls__left,
            .controls__right {
                top: 50%;
            }
            .controls__left {
                left: 0;
            }
            .controls__left:hover {
                left: 0;
            }
            .controls__right {
                right: 0;
                z-index: 1;
            }

            .slides-holder {
                border-radius: 50%;
                border: 2px solid #8eb8e5;
                transform-origin: center;
                display: flex;
                justify-content: center;
                align-items: center;
                position: relative;
                rotate: 90deg;
            }
            .slides-holder__item {
                border-radius: 50%;
                border: 2px solid #7c99b4;
                position: absolute;
                transform-origin: center;
                background-color: #222;
                transition: 0.3s linear all;
                filter: brightness(70%);
            }
            .slides-holder__item img {
                width: 100%;
                height: 100%;
                border-radius: 50%;
                user-select: none;
            }
            .slides-holder__item_active {
                filter: brightness(100%);
            }
            .descriptions {
                position: absolute;
                top: 20%;
                left: 20%;
            }
            .descriptions__item {
                width: 100%;
                height: 0%;
                opacity: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: opacity 0s 0s linear;
            }
            .descriptions__item_visible {
                height: 100%;
                opacity: 1;
                transition: opacity 0.6s 0s linear;
            }
            .descriptions__item h1,
            .descriptions__item .description {
                color: white;
                text-align: center;
            }
            .descriptions__item h1 {
                font-size: 200%;
                padding-top: 5px;
            }
            .descriptions__item .description {
                font-size: 100%;
                margin-top: 5px;
                padding: 0% 10%;
                text-overflow: ellipsis;
                overflow: hidden;
            }
        </style>
    </head>
    <body>
        <div class="slider">
            <div class="wrapper">
                <div class="controls">
                    <div class="controls__left">
                        <div class="icon-wrapper">bbbbbbbbbb</div>
                    </div>
                    <div class="controls__right">
                        <div class="icon-wrapper">aaaaaaaa</div>
                    </div>
                </div>
                <div class="slides-holder">
                    <div class="slides-holder__item slides-holder__item_active">
                        1
                    </div>
                    <div class="slides-holder__item">a</div>
                    <div class="slides-holder__item">b</div>
                    <div class="slides-holder__item">c</div>
                    <div class="slides-holder__item">d</div>
                    <div class="slides-holder__item">e</div>
                </div>
                <div class="descriptions">
                    <div class="descriptions__item descriptions__item_visible">
                        <h1>Slide 1</h1>
                        <p class="description">Desc 1</p>
                    </div>
                    <div class="descriptions__item">
                        <h1>Slide 2</h1>
                        <p class="description">Desc 2</p>
                    </div>
                    <div class="descriptions__item">
                        <h1>Slide 3</h1>
                        <p class="description">Desc 3</p>
                    </div>
                    <div class="descriptions__item">
                        <h1>Slide 4</h1>
                        <p class="description">Desc 4</p>
                    </div>
                    <div class="descriptions__item">
                        <h1>Slide 5</h1>
                        <p class="description">Desc 1</p>
                    </div>
                    <div class="descriptions__item">
                        <h1>Slide 6</h1>
                        <p class="description">Desc 1</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="scene">
            <div class="carousel">
                <div class="carousel_cell">
                    <div class="album_list"></div>
                    <div class="artist_img"></div>
                </div>
            </div>
        </div>
    </body>
    <script>
        let slider = document.querySelector(".slider");
        let slideSize = 0.2;
        let animationDuration = parseFloat(600);
        let currentAngle = 0;
        let currentSlide = 0;
        let timer;

        let wrapper = document.querySelector(".wrapper");
        let slides = document.querySelectorAll(".slides-holder__item");
        let descriptionsHolder = document.querySelector(".descriptions");
        let descriptions = document.querySelectorAll(".descriptions__item");
        let slidesHolder = document.querySelector(".slides-holder");
        let btnLeft = document.querySelector(".controls__left");
        let btnRight = document.querySelector(".controls__right");

        let stepAngle = (2 * Math.PI) / slides.length;

        slidesHolder.style.transitionDuration = `${animationDuration}ms`;

        function slideResize() {
            let radius,
                w = slider.getBoundingClientRect().width,
                h = slider.getBoundingClientRect().height;

            w > h ? (radius = w / 2) : (radius = h / 1.6);

            setSlideSize(Math.round(radius));
        }
        function setSlideSize(radius) {
            wrapper.style.width = `${radius * 2}px`;
            wrapper.style.height = `${radius * 2}px`;

            let r = 2 * radius * (1 - slideSize);
            slidesHolder.style.width = `${r}px`;
            slidesHolder.style.height = `${r}px`;
            slidesRepositioning(r / 2);

            // slidesHolder.style.marginTop = radius * slideSize + "px";
            descriptionsHolder.style.width = (r / 2 - r * slideSize) * 2 + "px";
            descriptionsHolder.style.height = r / 2 - r * slideSize + "px";

            slidesSize = Math.max(stepAngle * radius * (1 - slideSize) - 200);
            // slidesSize = stepAngle * radius * (1 - slideSize) - 200;

            descriptionsHolder.style.fontSize =
                window.innerHeight < window.innerWidth ? "1.2vh" : "1.2vw";
            for (let i = 0; i < slides.length; i++) {
                slides[i].style.width = slides[i].style.height =
                    slidesSize + "px";
            }
        }
        function slidesRepositioning(radius) {
            for (let i = 0; i < slides.length; i++) {
                let x = radius * Math.cos(stepAngle * i - Math.PI / 2),
                    y = radius * Math.sin(stepAngle * i - Math.PI / 2);
                slides[i].style.transform = `translate(${x}px,${y}px) rotate(${
                    ((stepAngle * 180) / Math.PI) * i - 90
                }deg)`;
            }
        }
        function slideRotate(multiplier) {
            removeStyle();

            if (currentSlide === slides.length - 1 && multiplier === -1) {
                slidesHolder.style.transform = "rotate( -360deg )";
                currentSlide = 0;
                currentAngle = 0;
                addActiveStyle();

                setTimeout(() => {
                    slidesHolder.style.transitionDuration = 0 + "s";
                    slidesHolder.style.transform = `rotate(${currentAngle}deg)`;
                    setTimeout(function () {
                        slidesHolder.style.transitionDuration =
                            animationDuration + "ms";
                    }, 20);
                }, animationDuration);
            } else if (currentSlide === 0 && multiplier === 1) {
                slidesHolder.style.transform = `rotate(${
                    (stepAngle * 180) / Math.PI
                }deg )`;
                currentSlide = slides.length - 1;
                currentAngle = (-(2 * Math.PI - stepAngle) * 180) / Math.PI;
                addActiveStyle();

                setTimeout(function () {
                    slidesHolder.style.transitionDuration = 0 + "s";
                    slidesHolder.style.transform = `rotate(${currentAngle}deg)`;
                    setTimeout(function () {
                        slidesHolder.style.transitionDuration =
                            animationDuration + "ms";
                    }, 20);
                }, animationDuration);
            } else {
                currentSlide -= multiplier;
                currentAngle += ((stepAngle * 180) / Math.PI) * multiplier;
                slidesHolder.style.transform = `rotate(${currentAngle}deg)`;
                addActiveStyle();
            }
        }
        function setNav() {
            btnLeft.onclick = function () {
                slideRotate(1);
            };
            btnRight.onclick = function () {
                slideRotate(-1);
            };
        }
        function disableNav() {
            btnLeft.onclick = null;
            btnRight.onclick = null;
        }

        function removeStyle() {
            let x = currentSlide;

            descriptions[x].classList.remove("descriptions__item_visible");
            slides[x].classList.remove("slides-holder__item_active");
            slides[x].style.height = slides[x].style.width = slidesSize + "px";
        }
        function addActiveStyle() {
            let x = currentSlide;

            descriptions[x].classList.add("descriptions__item_visible");
            slides[x].classList.add("slides-holder__item_active");
            slides[x].style.height = slides[x].style.width =
                slidesSize + 40 + "px";
        }

        setTimeout(() => {
            btnRight.addEventListener("click", () => {
                slideRotate(-1);
            });
        }, animationDuration);
        setTimeout(() => {
            btnLeft.addEventListener("click", () => {
                slideRotate(1);
            });
        }, animationDuration);
        slideResize();

        window.onresize = () => {
            clearTimeout(timer);
            timer = setTimeout(() => {
                slideResize();
            }, 200);
        };
    </script>
</html>
